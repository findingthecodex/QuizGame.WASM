@page "/quiz/animals"


<div style="
    min-height: 90vh; 
    display: flex; 
    flex-direction: column; 
    align-items: center;
    padding-top: 1rem;">

    <!-- Topic -->
    <MudText Typo="Typo.h1" Align="Align.Center" Class="mb-4">
        üê∂ Svenska Djur Quiz
    </MudText>
    
    <!-- Show Result -->
    <MudText Typo="Typo.h2" Align="Align.Center" Class="mb-4">
        @(currentQuestion + 1)/10
    </MudText>
    
    @if (showResult)
    {
        <MudCard Class="p-6" Style="max-width:500px; text-align:center; background-color: transparent">
            <MudText Typo="Typo.h2">üéâ Quiz Completed!</MudText>
            <MudText Typo="Typo.h3">
                Score: @score / 10
            </MudText>

            <MudButton Class="mt-4" OnClick="RestartQuiz">
                Play Again
            </MudButton>
        </MudCard>
    }
    else
    {
        <!-- H√§r ligger ditt nuvarande quiz -->
    

    <!-- The Question -->
    <MudCard Class="p-4" Style="max-width:600px; margin: 1.5rem auto; text-align: center; background-color:transparent">

        <MudText Typo="Typo.h2" Class="mb-3">
            @questions[currentQuestion].Question
        </MudText>

        <!-- Answer choices -->
        <MudGrid Justify="Justify.Center" Spacing="2">

            @foreach (var answer in questions[currentQuestion].Answers)
            {
                <MudItem xs="6" class="d-flex justify-center">

                    <MudButton 
                        Variant="Variant.Filled"
                        Color="Color.Primary"
                        Class="@GetButtonClass(answer)"
                        OnClick="@(() => SelectAnswer(answer))"
                        Disabled="@answered"
                        Style="
                    width: 220px;
                    height: 70px;
                    font-size: 1.5rem;
                    font-weight: 600;
                    border-radius: 16px;
                ">

                        @answer
                    </MudButton>

                </MudItem>
            }
        </MudGrid>

        <!-- Correct or Wrong text -->
        @if (answered)
        {
            <MudText Typo="Typo.h2" Class="mt-3" Color="@feedbackColor">
                @feedbackMessage
            </MudText>

            <!-- Next Question button -->
            <MudButton 
                Class="mt-3"
                Variant="Variant.Filled"
                Color="Color.Primary"
                OnClick="NextQuestion"
                Style="
                        width: 180px;
                        height: 50px;
                        font-size: 1rem;
                        font-weight: 700;
                        border-radius: 20px;
                        box-shadow: 0 0 15px rgba(0,0,0,0.7);
                ">
                Next Question
            </MudButton>
        }
        
        

    </MudCard>

    <MudText Typo="Typo.subtitle1" Class="mt-4">
        Score: @score
    </MudText>
    }
    
</div>

<!-- Copyright l√§ngst ner -->
<div style="
    margin-top: auto; 
    padding-bottom: 16px; 
    width: 100%;
    display: flex;
    justify-content: center;
    text-align: center;">
    
    <MudText Typo="Typo.caption" Color="Color.Secondary">
        ¬© 2026 FindingTheCode. All rights reserved.
    </MudText>
</div>

@code {
    
    int totalQuestions = 10;
    bool showResult = false;

    int currentQuestion = 0;
    int score = 0;
    bool answered = false;

    string feedbackMessage = "";
    Color feedbackColor = Color.Default;
    

    protected override void OnInitialized()
    {
        ShuffleQuestions();
    }

    /// <summary>
    ///  Shuffles Questions and answer buttons
    /// </summary>
    void ShuffleQuestions()
    {
        var rnd = new Random();
        questions=questions
            .OrderBy(q => rnd.Next())
            .Select(q => new QuizQuestion
                {
                    Question = q.Question,
                    CorrectAnswer = q.CorrectAnswer,
                    Answers = q.Answers.OrderBy(a => rnd.Next())
                        .ToList()
                })
            .Take(totalQuestions)
            .ToList();
    }
    
    // Green red button
    void RestartQuiz()
    {
        currentQuestion = 0;
        score = 0;
        showResult = false;
        ShuffleQuestions();
    }
    
    void SelectAnswer(string answer)
    {
        if (answered)
            return;

        selectedAnswer = answer;
        answered = true;

        if (answer == questions[currentQuestion].CorrectAnswer)
        {
            score++;
            feedbackMessage = "Correct! üéâ";
            feedbackColor = Color.Success;
        }
        else
        {
            feedbackMessage = $"Wrong üò¢ Correct answer: {questions[currentQuestion].CorrectAnswer}";
            feedbackColor = Color.Error;
        }
    }

    void NextQuestion()
    {
        answered = false;
        feedbackMessage = "";
        selectedAnswer = "";

        if (currentQuestion < questions.Count - 1)
            currentQuestion++;
        else
            showResult = true;
    }
    
    string GetButtonClass(string answer)
    {
        // Innan man svarat
        if (!answered)
            return answer == selectedAnswer
                ? "glow-button glow-preselect"
                : "glow-button";

        // Efter svar

        // R√§tt svar ‚Üí gr√∂n
        if (answer == questions[currentQuestion].CorrectAnswer)
            return "glow-button glow-selected";

        // Fel valt ‚Üí r√∂d
        if (answer == selectedAnswer &&
            answer != questions[currentQuestion].CorrectAnswer)
            return "glow-button glow-wrong";

        return "glow-button";
    }
    
    string selectedAnswer = "";

    List<QuizQuestion> questions = new()
    {
       
        new QuizQuestion
{
    Question = "Vilket svenskt djur byter f√§rg p√• p√§lsen mellan sommar och vinter?",
    CorrectAnswer = "Fj√§llr√§v",
    Answers = new() { "Hermelin", "Fj√§llr√§v", "Lodjur", "Utter" }
},
new QuizQuestion
{
    Question = "Vilket djur √§r mest anpassat f√∂r ett liv i vatten?",
    CorrectAnswer = "Utter",
    Answers = new() { "Mink", "Utter", "B√§ver", "Gr√§vling" }
},
new QuizQuestion
{
    Question = "Vilket djur kan lukta sig till mat flera kilometer bort?",
    CorrectAnswer = "Bj√∂rn",
    Answers = new() { "√Ñlg", "Bj√∂rn", "R√§v", "M√•rd" }
},
new QuizQuestion
{
    Question = "Vilket djur har klor som inte g√•r att dra in?",
    CorrectAnswer = "Hund",
    Answers = new() { "Katt", "Hund", "Lodjur", "R√§v" }
},
new QuizQuestion
{
    Question = "Vilket djur kan simma l√§ngst str√§ckor i kallt vatten?",
    CorrectAnswer = "S√§l",
    Answers = new() { "Utter", "S√§l", "Mink", "B√§ver" }
},
new QuizQuestion
{
    Question = "Vilket djur lever ofta i par resten av livet?",
    CorrectAnswer = "Trana",
    Answers = new() { "Svala", "Trana", "Skata", "Kr√•ka" }
},
new QuizQuestion
{
    Question = "Vilket djur anv√§nder ekolokalisering?",
    CorrectAnswer = "Fladdermus",
    Answers = new() { "Uggla", "Fladdermus", "S√§l", "Delfin" }
},
new QuizQuestion
{
    Question = "Vilket djur √§r mest aktivt i skymning och gryning?",
    CorrectAnswer = "R√•djur",
    Answers = new() { "√Ñlg", "R√•djur", "Hare", "Gr√§vling" }
},
new QuizQuestion
{
    Question = "Vilket djur kan gr√§va g√•ngar flera meter under marken?",
    CorrectAnswer = "Gr√§vling",
    Answers = new() { "R√§v", "Gr√§vling", "Mullvad", "Igelkott" }
},
new QuizQuestion
{
    Question = "Vilket djur kan stanna under vattnet i √∂ver 20 minuter?",
    CorrectAnswer = "S√§l",
    Answers = new() { "Utter", "B√§ver", "S√§l", "Mink" }
},
new QuizQuestion
{
    Question = "Vilket djur kan h√∂ra ljud som m√§nniskor inte uppfattar?",
    CorrectAnswer = "Uggla",
    Answers = new() { "H√∂k", "Uggla", "Falk", "Korp" }
},
new QuizQuestion
{
    Question = "Vilket djur har giftiga t√§nder?",
    CorrectAnswer = "Huggorm",
    Answers = new() { "Snok", "Huggorm", "√ñdla", "Skogsorm" }
},
new QuizQuestion
{
    Question = "Vilket djur har den starkaste bitkraften i Sverige?",
    CorrectAnswer = "Bj√∂rn",
    Answers = new() { "Varg", "Bj√∂rn", "Gr√§vling", "Lodjur" }
},
new QuizQuestion
{
    Question = "Vilket djur lever ofta i kolonier?",
    CorrectAnswer = "S√§l",
    Answers = new() { "Utter", "S√§l", "Mink", "B√§ver" }
},
new QuizQuestion
{
    Question = "Vilket djur kan k√§nna vibrationer i marken?",
    CorrectAnswer = "Mullvad",
    Answers = new() { "Mullvad", "Gr√§vling", "Hare", "Igelkott" }
},
new QuizQuestion
{
    Question = "Vilket djur √§r mest anpassat f√∂r kyla?",
    CorrectAnswer = "Myskoxe",
    Answers = new() { "Ren", "Myskoxe", "Bj√∂rn", "Varg" }
},
new QuizQuestion
{
    Question = "Vilket djur kan hoppa l√§ngst i f√∂rh√•llande till sin storlek?",
    CorrectAnswer = "Loppa",
    Answers = new() { "Groda", "Kanin", "Loppa", "Mus" }
},
new QuizQuestion
{
    Question = "Vilket djur har b√§st m√∂rkerseende?",
    CorrectAnswer = "Uggla",
    Answers = new() { "R√§v", "Uggla", "√Ñlg", "Hjort" }
},
new QuizQuestion
{
    Question = "Vilket djur kan √∂verleva i extrema fj√§llmilj√∂er?",
    CorrectAnswer = "Fj√§llr√§v",
    Answers = new() { "Hermelin", "Fj√§llr√§v", "M√•rd", "Utter" }
},
new QuizQuestion
{
    Question = "Vilket djur kommunicerar med doftsignaler?",
    CorrectAnswer = "Varg",
    Answers = new() { "R√§v", "Varg", "Bj√∂rn", "Lodjur" }
}
        
    };
}
